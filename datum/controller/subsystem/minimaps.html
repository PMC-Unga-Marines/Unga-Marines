<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../../../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>&#x2F;datum&#x2F;controller&#x2F;subsystem&#x2F;minimaps - byond</title>
</head>
<body>
<header>
    <a href="index.html">byond</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
 &mdash; <a href="datum/controller/subsystem/minimaps.html#var">Var Details</a> - <a href="datum/controller/subsystem/minimaps.html#proc">Proc Details</a></header>
<main>
<h1>minimaps <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/minimaps.html">minimaps</a></aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L18">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 18"/></a></h1>

<table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/drawn_images">drawn_images</a></th><td>assoc list of hash = image of images drawn by players</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/earlyadds">earlyadds</a></th><td>list of callbacks we need to invoke late because Initialize happens early, or a Z-level was loaded after init</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/hashed_minimaps">hashed_minimaps</a></th><td>assoc list of minimap objects that are hashed so we have to update as few as possible</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/images_by_source">images_by_source</a></th><td>Assoc list of images we hold by their source</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/minimaps_by_z">minimaps_by_z</a></th><td>Minimap hud display datums sorted by zlevel</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/removal_cbs">removal_cbs</a></th><td>Assoc list of removal callbacks to invoke to remove images from the raw lists</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/update_targets">update_targets</a></th><td>the update target datums, sorted by update flag type</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/update_targets_unsorted">update_targets_unsorted</a></th><td>Nonassoc list of updators we want to have their overlays reapplied</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#var/updators_by_datum">updators_by_datum</a></th><td>list of holders for data relating to tracked zlevel and tracked atum</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/add_marker">add_marker</a></th><td>Adds an atom we want to track with blips to the subsystem
Arguments:</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/add_to_updaters">add_to_updaters</a></th><td>Adds an atom to the processing updators that will have blips drawn on them
Arguments:</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/fetch_minimap_object">fetch_minimap_object</a></th><td>Fetches a /atom/movable/screen/minimap instance or creates on if none exists
Note this does not destroy them when the map is unused, might be a potential thing to do?
Arguments:</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/get_drawing_image">get_drawing_image</a></th><td>fetches the drawing icon for a minimap flag and returns it, creating it if needed. assumes minimap_flag is ONE flag</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/load_new_z">load_new_z</a></th><td>Creates a minimap for a particular z level</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/on_z_change">on_z_change</a></th><td>Called on zlevel change of a blip-atom so we can update the image lists as needed</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/remove_earlyadd">remove_earlyadd</a></th><td>Removes the object from the earlyadds list, in case it was qdel'd before the z-level was fully loaded</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/remove_marker">remove_marker</a></th><td>Removes an atom and it's blip from the subsystem</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/remove_updator">remove_updator</a></th><td>Removes a atom from the subsystems updating overlays</td></tr>
            <tr><th><a href="datum/controller/subsystem/minimaps.html#proc/removeimage">removeimage</a></th><td>removes an image from raw tracked lists, invoked by callback</td></tr></table>
    <h2 id="var">Var Details</h2><h3 id="var/drawn_images"><aside class="declaration">var </aside>drawn_images
            <aside>&ndash; /list/image</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L37">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 37"/></a></h3>
        <p>assoc list of hash = image of images drawn by players</p><h3 id="var/earlyadds"><aside class="declaration">var </aside>earlyadds
            <aside>&ndash; /list/list/datum/callback</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L39">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 39"/></a></h3>
        <p>list of callbacks we need to invoke late because Initialize happens early, or a Z-level was loaded after init</p><h3 id="var/hashed_minimaps"><aside class="declaration">var </aside>hashed_minimaps
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L41">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 41"/></a></h3>
        <p>assoc list of minimap objects that are hashed so we have to update as few as possible</p><h3 id="var/images_by_source"><aside class="declaration">var </aside>images_by_source
            <aside>&ndash; /list/image</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L27">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 27"/></a></h3>
        <p>Assoc list of images we hold by their source</p><h3 id="var/minimaps_by_z"><aside class="declaration">var </aside>minimaps_by_z
            <aside>&ndash; /list/datum/hud_displays</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L25">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 25"/></a></h3>
        <p>Minimap hud display datums sorted by zlevel</p><h3 id="var/removal_cbs"><aside class="declaration">var </aside>removal_cbs
            <aside>&ndash; /list/datum/callback</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L33">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 33"/></a></h3>
        <p>Assoc list of removal callbacks to invoke to remove images from the raw lists</p><h3 id="var/update_targets"><aside class="declaration">var </aside>update_targets
            <aside>&ndash; /list</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L29">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 29"/></a></h3>
        <p>the update target datums, sorted by update flag type</p><h3 id="var/update_targets_unsorted"><aside class="declaration">var </aside>update_targets_unsorted
            <aside>&ndash; /list/datum/minimap_updator</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L31">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 31"/></a></h3>
        <p>Nonassoc list of updators we want to have their overlays reapplied</p><h3 id="var/updators_by_datum"><aside class="declaration">var </aside>updators_by_datum
            <aside>&ndash; /list/datum/minimap_updator</aside>
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L35">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 35"/></a></h3>
        <p>list of holders for data relating to tracked zlevel and tracked atum</p><h2 id="proc">Proc Details</h2><h3 id="proc/add_marker"><aside class="declaration">proc </aside>add_marker<aside>(/<a href="atom.html">atom</a>/target, hud_flags, /<a href="image.html">image</a>/blip) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L219">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 219"/></a></aside>
        </h3>
        <p>Adds an atom we want to track with blips to the subsystem
Arguments:</p>
<ul>
<li>target: atom we want to track</li>
<li>hud_flags: tracked HUDs we want this atom to be displayed on</li>
<li>marker: image or mutable_appearance we want to be using on the map</li>
</ul><h3 id="proc/add_to_updaters"><aside class="declaration">proc </aside>add_to_updaters<aside>(/<a href="atom.html">atom</a>/target, flags, ztarget) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L150">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 150"/></a></aside>
        </h3>
        <p>Adds an atom to the processing updators that will have blips drawn on them
Arguments:</p>
<ul>
<li>target: the target we want to be updating the overlays on</li>
<li>flags: flags for the types of blips we want to be updated</li>
<li>ztarget: zlevel we want to be updated with</li>
</ul><h3 id="proc/fetch_minimap_object"><aside class="declaration">proc </aside>fetch_minimap_object<aside>(zlevel, flags) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L352">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 352"/></a></aside>
        </h3>
        <p>Fetches a /atom/movable/screen/minimap instance or creates on if none exists
Note this does not destroy them when the map is unused, might be a potential thing to do?
Arguments:</p>
<ul>
<li>zlevel: zlevel to fetch map for</li>
<li>flags: map flags to fetch from</li>
</ul><h3 id="proc/get_drawing_image"><aside class="declaration">proc </aside>get_drawing_image<aside>(zlevel, minimap_flag) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L363">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 363"/></a></aside>
        </h3>
        <p>fetches the drawing icon for a minimap flag and returns it, creating it if needed. assumes minimap_flag is ONE flag</p><h3 id="proc/load_new_z"><aside class="declaration">proc </aside>load_new_z<aside>(/<a href="datum.html">datum</a>/dcs, /<a href="datum.html">datum</a>/space_level/z_level) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L78">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 78"/></a></aside>
        </h3>
        <p>Creates a minimap for a particular z level</p><h3 id="proc/on_z_change"><aside class="declaration">proc </aside>on_z_change<aside>(/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/source, oldz, newz) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L278">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 278"/></a></aside>
        </h3>
        <p>Called on zlevel change of a blip-atom so we can update the image lists as needed</p>
<p>TODO gross amount of assoc usage and unneeded ALL FLAGS iteration</p><h3 id="proc/remove_earlyadd"><aside class="declaration">proc </aside>remove_earlyadd<aside>(/<a href="atom.html">atom</a>/source) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L250">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 250"/></a></aside>
        </h3>
        <p>Removes the object from the earlyadds list, in case it was qdel'd before the z-level was fully loaded</p><h3 id="proc/remove_marker"><aside class="declaration">proc </aside>remove_marker<aside>(/<a href="atom.html">atom</a>/source) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L332">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 332"/></a></aside>
        </h3>
        <p>Removes an atom and it's blip from the subsystem</p><h3 id="proc/remove_updator"><aside class="declaration">proc </aside>remove_updator<aside>(/<a href="atom.html">atom</a>/target) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L162">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 162"/></a></aside>
        </h3>
        <p>Removes a atom from the subsystems updating overlays</p><h3 id="proc/removeimage"><aside class="declaration">proc </aside>removeimage<aside>(/<a href="image.html">image</a>/blip, /<a href="atom.html">atom</a>/target, hud_flags) 
        
    
            <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/blob/775a83a36b693f885ce185e25d21292e5068cf5e/code/controllers/subsystem/minimaps.dm#L263">
        <img src="git.png" width="16" height="16" title="code&#x2F;controllers&#x2F;subsystem&#x2F;minimaps.dm 263"/></a></aside>
        </h3>
        <p>removes an image from raw tracked lists, invoked by callback</p></main>
<footer>
    tgmc.dme
    <a href="https://github.com/PMC-Unga-Marines/Unga-Marines/tree/775a83a36b693f885ce185e25d21292e5068cf5e">775a83a</a>
        (master) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.8.0</a></footer>
</body>
</html>
